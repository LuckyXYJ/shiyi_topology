# 什么时候需要进行JVM调优

在平常的开发中最多的还是用的默认的JVM参数进行运行，如果不是非常必要不建议去调整JVM的参数，更多的还是考虑代码层面的优化，只有在代码已经优化到极致了才需要考虑通过JVM的参数进行调优。

## 系统不稳定，时快时慢

1. 由于full gc的问题，新生代设置过小，导致老年代过大。
2. 新生代分配过大，导致新生代的gc回收缓慢。
3. CPU飙升，老年代full GC次数太频繁

处理: 对新生代和老年代分配合适的内存或者比例，通过不断压测观察新生代和老年代的内存空间占用以及full gc的次数。



## 系统内存不够，经常出现OOM导致系统崩溃

首先，这种情况下要通过+xx:HeapDumpOnOutOfMemoryError参数开启JVM在OOM之后dump的线程数据，通过观察hprof文件找出内存泄漏的代码。

其次，在JDK1.7以及之前，由于方法区是被划分到JVM中的内存的，因此在大量动态对象创建产生的class信息、方法信息也会导致OOM，解决方法是通过升级到1.87以上，1.8将方法区移动到了元空间中，使用linux的直接内存进行管理。

